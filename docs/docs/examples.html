<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Code Examples</title><link rel="shortcut icon" type="image/x-icon" href="../favicon.ico"></link><script type="text/javascript" src="../scripts/theme.js"></script><script type="text/javascript" src="../scripts/searchData.js" defer="true"></script><script type="text/javascript" src="../scripts/scastieConfiguration.js" defer="true"></script><link rel="stylesheet" href="../styles/nord-light.css"></link><link rel="stylesheet" href="../styles/scalastyle.css"></link><link rel="stylesheet" href="../styles/colors.css"></link><link rel="stylesheet" href="../styles/dotty-icons.css"></link><link rel="stylesheet" href="../styles/diagram.css"></link><link rel="stylesheet" href="../styles/filter-bar.css"></link><link rel="stylesheet" href="../styles/code-snippets.css"></link><link rel="stylesheet" href="../styles/searchbar.css"></link><link rel="stylesheet" href="../styles/social-links.css"></link><link rel="stylesheet" href="../styles/ux.css"></link><link rel="stylesheet" href="../styles/versions-dropdown.css"></link><link rel="stylesheet" href="../styles/fontawesome.css"></link><script type="text/javascript" src="../hljs/highlight.min.js" defer="true"></script><script type="text/javascript" src="../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../scripts/scaladoc-scalajs.js" defer="true"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="https://scastie.scala-lang.org/embedded.js" defer="true"></script><script type="text/javascript" src="../scripts/data.js" defer="true"></script><script>var pathToRoot = "../";</script><script>var githubContributorsUrl = "https://api.github.com/repos/charpov/TinyScalaUtils";</script><script>var githubContributorsFilename = "site/_docs/examples.md";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><div class="projectName">TinyScalaUtils</div></span><div id="version"><div class="versions-dropdown"><div onclick="dropdownHandler()" id="dropdown-button" class="dropdownbtn dropdownbtnactive"><div class="projectVersion">1.0.0</div><div id="dropdown-content" class="dropdown-content"><input type="text" placeholder="Search..." id="dropdown-input" onkeyup="filterFunction()"></input></div></div></div></div><div class="socials"></div></div><div id="paneSearch"></div><nav id="sideMenu2"><div class="ni expanded"><span class="nh expanded"><span class="ar"></span><a href="index.html"><span>TinyScalaUtils</span></a></span><div class="ni expanded"><span class="nh selected"><a href="examples.html"><span>Code Examples</span></a></span></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../index.html"><span>API</span></a></span><div class="ni "><span class="nh "><a href="../tinyscalautils/assertions.html"><span class="micon pa"></span><span>tinyscalautils.assertions</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/collection.html"><span class="micon pa"></span><span>tinyscalautils.collection</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/control.html"><span class="micon pa"></span><span>tinyscalautils.control</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/io.html"><span class="micon pa"></span><span>tinyscalautils.io</span></a></span></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../tinyscalautils/lang.html"><span class="micon pa"></span><span>tinyscalautils.lang</span></a></span><div class="ni "><span class="nh "><a href="../tinyscalautils/lang/InterruptibleConstructor.html"><span class="micon tr"></span><span>InterruptibleConstructor</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/lang/InterruptibleEquality.html"><span class="micon tr"></span><span>InterruptibleEquality</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/lang/StackOverflowException.html"><span class="micon cl"></span><span>StackOverflowException</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../tinyscalautils/text.html"><span class="micon pa"></span><span>tinyscalautils.text</span></a></span><div class="ni "><span class="nh "><a href="../tinyscalautils/text/CharLetters$.html"><span class="micon ob"></span><span>CharLetters</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/text/PrintingMode.html"><span class="micon tr"></span><span>PrintingMode</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/text/StringLetters$.html"><span class="micon ob"></span><span>StringLetters</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../tinyscalautils/threads.html"><span class="micon pa"></span><span>tinyscalautils.threads</span></a></span><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/DelayedFuture$.html"><span class="micon ob"></span><span>DelayedFuture</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/Execute$.html"><span class="micon ob"></span><span>Execute</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/Executors.html"><span class="micon cl"></span><span>Executors</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/Executors$.html"><span class="micon ob"></span><span>Executors</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/KeepThreadsFactory.html"><span class="micon cl"></span><span>KeepThreadsFactory</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/KeepThreadsFactory$.html"><span class="micon ob"></span><span>KeepThreadsFactory</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/MarkedThread.html"><span class="micon tr"></span><span>MarkedThread</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/MarkedThreadFactory.html"><span class="micon cl"></span><span>MarkedThreadFactory</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/MarkedThreadFactory$.html"><span class="micon ob"></span><span>MarkedThreadFactory</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/StoppableThread.html"><span class="micon cl"></span><span>StoppableThread</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/threads/Timer.html"><span class="micon tr"></span><span>Timer</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../tinyscalautils/timing.html"><span class="micon pa"></span><span>tinyscalautils.timing</span></a></span><div class="ni "><span class="nh "><a href="../tinyscalautils/timing/SlowIterator$.html"><span class="micon ob"></span><span>SlowIterator</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/timing/SlowLazyList$.html"><span class="micon ob"></span><span>SlowLazyList</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/timing/SlowSource$.html"><span class="micon ob"></span><span>SlowSource</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../tinyscalautils/util.html"><span class="micon pa"></span><span>tinyscalautils.util</span></a></span><div class="ni "><span class="nh "><a href="../tinyscalautils/util/FastRandom.html"><span class="micon cl"></span><span>FastRandom</span></a></span></div><div class="ni "><span class="nh "><a href="../tinyscalautils/util/FastRandom$.html"><span class="micon ob"></span><span>FastRandom</span></a></span></div></div></div></div></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="scaladoc-searchBar"></div><main id="main-content"><div class="breadcrumbs container"><a href="index.html">TinyScalaUtils</a>/<a href="examples.html">Code Examples</a></div><div id="content"><html>
 <head></head>
 <body>
  <section id="code-examples"> 
   <h1><a href="#code-examples" class="anchor"></a>Code Examples</h1> 
  </section>
  <section id="package-lang"> 
   <h2><a href="#package-lang" class="anchor"></a>Package <code>lang</code></h2> 
  </section>
  <section id="unit"> 
   <h3><a href="#unit" class="anchor"></a><code>unit</code></h3> 
   <p>A <code>unit</code> value is defined instead of the usual <code>()</code> token for improved readability, e.g.:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>f(((), ())) // hard to parse
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>import tinyscalautils.lang.unit
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>f((unit, unit)) // easier
</span></code></pre>
   </div>
  </section>
  <section id="interruptibleconstructor--interruptibleequality"> 
   <h3><a href="#interruptibleconstructor--interruptibleequality" class="anchor"></a><code>InterruptibleConstructor</code> / <code>InterruptibleEquality</code></h3> 
   <p>Checks the interrupted status of the current thread before instance creation and/or equality and hash code:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.lang.{ InterruptibleConstructor, InterruptibleEquality }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>class C extends InterruptibleConstructor, InterruptibleEquality
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>val c = C() // throws InterruptedException if thread is interrupted
</span><span id="5" class=""><span class="tooltip-container"></span>c == c // throws InterruptedException if thread is interrupted
</span><span id="6" class=""><span class="tooltip-container"></span>c.## // throws InterruptedException if thread is interrupted
</span></code></pre>
   </div>
  </section>
  <section id="package-control"> 
   <h2><a href="#package-control" class="anchor"></a>Package <code>control</code></h2> 
  </section>
  <section id="times"> 
   <h3><a href="#times" class="anchor"></a><code>times</code></h3> 
   <p>This is the same <code>times</code> as in <code>Scalactic</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.control.times
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>3 times {
</span><span id="3" class=""><span class="tooltip-container"></span>   println("Beetlejuice!")
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div>
  </section>
  <section id="limitedstack--stackoverflowexception"> 
   <h3><a href="#limitedstack--stackoverflowexception" class="anchor"></a><code>limitedStack</code> / <code>StackOverflowException</code></h3> 
   <p><code>StackOverflowException</code> can replace <code>StackOverflowError</code> where the latter would not adequately be caught:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.lang.StackOverflowException
</span><span id="1" class=""><span class="tooltip-container"></span>import tinyscalautils.control.limitedStack
</span><span id="2" class=""><span class="tooltip-container"></span>
</span><span id="3" class=""><span class="tooltip-container"></span>def f(x: Int): Int = 1 + f(x + 1)
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>val t = Try(f(0)) // dies with StackOverflowError, no usable t value
</span><span id="6" class=""><span class="tooltip-container"></span>
</span><span id="7" class=""><span class="tooltip-container"></span>val t = Try(limitedStack(f(0)))
</span><span id="8" class=""><span class="tooltip-container"></span>t.isFailure // true
</span><span id="9" class=""><span class="tooltip-container"></span>t.failed.get.isInstanceOf[StackOverflowException] // true
</span></code></pre>
   </div>
  </section>
  <section id="interruptibly"> 
   <h3><a href="#interruptibly" class="anchor"></a><code>interruptibly</code></h3> 
   <p>Checks the interrupted status of the current thread before running some code:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.control.interruptibly
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>while true do interruptibly {
</span><span id="3" class=""><span class="tooltip-container"></span>   x += 1
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>The infinite loops terminates with <code>InterruptedException</code> if the thread is interrupted.</p> 
  </section>
  <section id="package-collection"> 
   <h2><a href="#package-collection" class="anchor"></a>Package <code>collection</code></h2> 
  </section>
  <section id="circular"> 
   <h3><a href="#circular" class="anchor"></a><code>circular</code></h3> 
   <p>Produces an infinite collection of elements by continuously repeating a finite collection:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.collection.circular
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val i: Iterator[Int] = List(1, 2, 3).circular
</span><span id="3" class=""><span class="tooltip-container"></span>// i is an infinite iterator: 1,2,3,1,2,3,1,2,3,...
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>i.take(10).toList // the list 1,2,3,1,2,3,1,2,3,1
</span></code></pre>
   </div>
  </section>
  <section id="randomly"> 
   <h3><a href="#randomly" class="anchor"></a><code>randomly</code></h3> 
   <p>Produces an infinite collection of elements randomly selected from a finite collection:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.collection.randomly
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>given Random = ...
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>val i: Iterator[Int] = List(1, 2, 3).randomly
</span><span id="5" class=""><span class="tooltip-container"></span>// i is an infinite iterator of 1s, 2s and 3s, in a random order
</span></code></pre>
   </div>
  </section>
  <section id="pickonepickoneoption"> 
   <h3><a href="#pickonepickoneoption" class="anchor"></a><code>pickOne/pickOneOption</code></h3> 
   <p>Produces a randomly selected element from a finite, non-empty collection:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.collection.pickOne
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val n: Int = List(1, 2, 3).pickOne
</span><span id="3" class=""><span class="tooltip-container"></span>// n is one of 1, 2 or 3, randomly chosen
</span></code></pre>
   </div> 
   <p>Uses a given <code>Random</code> in scope. Exists also as <code>pickOneOption</code> to handle empty collections. These methods should not be used in a loop over the same collection; use <code>randomly</code> instead.</p> 
  </section>
  <section id="package-assertions"> 
   <h2><a href="#package-assertions" class="anchor"></a>Package <code>assertions</code></h2> 
  </section>
  <section id="require--requirestate"> 
   <h3><a href="#require--requirestate" class="anchor"></a><code>require</code> / <code>requireState</code></h3> 
   <p>Simple precondition checking:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.assertions.require
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>// Scala style:
</span><span id="3" class=""><span class="tooltip-container"></span>require(cond, s"bad argument because ${someMethod()}")
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>// Java style:
</span><span id="6" class=""><span class="tooltip-container"></span>require(cond, "bad argument because %s", someMethod())
</span></code></pre>
   </div> 
   <p>In either case, <code>someMethod()</code> is only evaluated if the condition is false.</p> 
   <p>When a requirement fails, <code>require</code> throws <code>IllegalArgumentException</code> while <code>requireState</code> throws <code>IllegalStateException</code>.</p> 
  </section>
  <section id="checknonnull"> 
   <h3><a href="#checknonnull" class="anchor"></a><code>checkNonNull</code></h3> 
   <p>A utility to help reject <code>null</code> with <code>IllegalArgumentException</code> instead of <code>NullPointerException</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>require(str.nonEmpty, "string cannot be empty") // throws NPE if str is null, Java style
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>import tinyscalautils.assertions.checkNonNull
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>require(checkNonNull(str).nonEmpty, "string cannot be empty") // throws IllegalArgumentException on null or empty string
</span></code></pre>
   </div>
  </section>
  <section id="implies"> 
   <h3><a href="#implies" class="anchor"></a><code>implies</code></h3> 
   <p>Logical implication:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>val s: IndexedSeq[Int] = ...
</span><span id="1" class=""><span class="tooltip-container"></span>require(!s.indices.contains(i) || s(i) &gt; 0)
</span><span id="2" class=""><span class="tooltip-container"></span>
</span><span id="3" class=""><span class="tooltip-container"></span>import tinyscalautils.assertions.implies
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>require(s.indices.contains(i) implies s(i) &gt; 0)
</span></code></pre>
   </div> 
   <p>The evaluation is short-circuited: RHS is evaluated only if LHS is true. Operator also available under the symbolic name <code>==&gt;</code>.</p> 
  </section>
  <section id="in"> 
   <h3><a href="#in" class="anchor"></a><code>in</code></h3> 
   <p>An infix operator that swaps the arguments of <code>contains</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.assertions.in
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>value in (1 to 10) // same as (1 to 10) contains value
</span></code></pre>
   </div>
  </section>
  <section id="package-text"> 
   <h2><a href="#package-text" class="anchor"></a>Package <code>text</code></h2> 
  </section>
  <section id="stringletterscharletters"> 
   <h3><a href="#stringletterscharletters" class="anchor"></a><code>StringLetters/CharLetters</code></h3> 
   <p>All cap letters as strings or characters:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import StringLetters.*
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val list = List(A, B, C)
</span><span id="3" class=""><span class="tooltip-container"></span>assert(list.tail.head == B)
</span></code></pre>
   </div>
  </section>
  <section id="shortpad"> 
   <h3><a href="#shortpad" class="anchor"></a><code>short/pad</code></h3> 
   <p>Shortens or pads strings:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.text.{ short, pad }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val str = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
</span><span id="3" class=""><span class="tooltip-container"></span>str.short // "ABCDEFGHIJKLMNOPQRSTUVWXYZabc..."
</span><span id="4" class=""><span class="tooltip-container"></span>str.short(10) // "ABCDEFG..."
</span><span id="5" class=""><span class="tooltip-container"></span>"X".pad(5) // "    X"
</span><span id="6" class=""><span class="tooltip-container"></span>"X".pad(5, padding = '.') // "....X"
</span></code></pre>
   </div> 
   <p>Note that standard method <code>padTo</code> pads strings <em>on the right</em>.</p> 
  </section>
  <section id="printfprintln"> 
   <h3><a href="#printfprintln" class="anchor"></a><code>printf/println</code></h3> 
   <p>Adds thread and/or time information to print statements:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.text.{ println, timeMode }
</span><span id="1" class=""><span class="tooltip-container"></span>   println("foo") // prints: at 13:02:13.207: foo
</span><span id="2" class=""><span class="tooltip-container"></span>   
</span><span id="3" class=""><span class="tooltip-container"></span>   import tinyscalautils.text.{ println, timeDemoMode }
</span><span id="4" class=""><span class="tooltip-container"></span>   println("foo") // prints: at XX:XX:13.207: foo
</span><span id="5" class=""><span class="tooltip-container"></span>   
</span><span id="6" class=""><span class="tooltip-container"></span>   import tinyscalautils.text.{ println, threadMode }
</span><span id="7" class=""><span class="tooltip-container"></span>   println("foo") // prints: main: foo
</span><span id="8" class=""><span class="tooltip-container"></span>   
</span><span id="9" class=""><span class="tooltip-container"></span>   import tinyscalautils.text.{ println, threadTimeMode }
</span><span id="10" class=""><span class="tooltip-container"></span>   println("foo") // prints: main at 13:02:13.207: foo
</span><span id="11" class=""><span class="tooltip-container"></span>   
</span><span id="12" class=""><span class="tooltip-container"></span>   import tinyscalautils.text.{ println, threadTimeDemoMode }
</span><span id="13" class=""><span class="tooltip-container"></span>   println("foo") // prints: main at XX:XX:13.207: foo
</span><span id="14" class=""><span class="tooltip-container"></span>
</span><span id="15" class=""><span class="tooltip-container"></span>   import tinyscalautils.text.{ println, standardMode }
</span><span id="16" class=""><span class="tooltip-container"></span>   println("foo") // prints: foo
</span><span id="17" class=""><span class="tooltip-container"></span>   
</span><span id="18" class=""><span class="tooltip-container"></span>   import tinyscalautils.text.{ println, silentMode }
</span><span id="19" class=""><span class="tooltip-container"></span>   println("foo") // prints nothing
</span></code></pre>
   </div> 
   <p>Function <code>printf</code> works similarly. These functions can also be imported as:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.text.threadTimeMode.println
</span></code></pre>
   </div> 
   <p>which is simpler for most usages (i.e., when not using mode arguments explicitly).</p> 
  </section>
  <section id="printout"> 
   <h3><a href="#printout" class="anchor"></a><code>printout</code></h3> 
   <p>Captures the output of print statements into a string:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>val str = printout {
</span><span id="1" class=""><span class="tooltip-container"></span>   Console.out.print("hello")
</span><span id="2" class=""><span class="tooltip-container"></span>   Console.err.println(" world")
</span><span id="3" class=""><span class="tooltip-container"></span>} // the string "hello"
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>val str = printout(includeErr = true) {
</span><span id="6" class=""><span class="tooltip-container"></span>   Console.out.print("hello")
</span><span id="7" class=""><span class="tooltip-container"></span>   Console.err.println(" world")
</span><span id="8" class=""><span class="tooltip-container"></span>} // the string "hello world\n"
</span></code></pre>
   </div> 
   <p>By default, only <code>Console.out</code> (and <code>Predef.print</code> and <code>tinyscalautils.text.print</code>, which are based on it) is captured, but <code>System.out</code> and <code>System.err</code> are <em>not</em> captured. This can be changed with an option:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>val str = printout(includeSystem = true) {
</span><span id="1" class=""><span class="tooltip-container"></span>   Console.out.print("hello")
</span><span id="2" class=""><span class="tooltip-container"></span>   System.out.println(" world")
</span><span id="3" class=""><span class="tooltip-container"></span>} // the string "hello world\n"
</span></code></pre>
   </div> 
   <p>Note that <code>System.out</code> and <code>System.err</code> are global variables, shared among threads, while <code>Console.out</code> can be different for different threads. To capture the output of newly created threads, these threads should be created within the <code>printout</code> function.</p> 
  </section>
  <section id="package-timing"> 
   <h2><a href="#package-timing" class="anchor"></a>Package <code>timing</code></h2> 
  </section>
  <section id="sleep"> 
   <h3><a href="#sleep" class="anchor"></a><code>sleep</code></h3> 
   <p>Suspends the running thread for a specified number of seconds:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.timing.{ getTime, sleep }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>sleep(3.0) // sleeps 3 seconds, starting from now
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>val start = getTime()
</span><span id="5" class=""><span class="tooltip-container"></span>... 
</span><span id="6" class=""><span class="tooltip-container"></span>sleep(3.0, start) // sleeps 3 seconds, starting from start time
</span></code></pre>
   </div> 
   <p>This last example won't sleep at all if more than 3 seconds have already elapsed since time <code>start</code>.</p> 
   <p>This method <code>sleep</code> does not undershoot even if <code>Thread.sleep</code> does, and does not throw <code>InterruptedException</code>.</p> 
  </section>
  <section id="delay"> 
   <h3><a href="#delay" class="anchor"></a><code>delay</code></h3> 
   <p>Delays returning a value:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.timing.delay
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val result = delay(3.0) {
</span><span id="3" class=""><span class="tooltip-container"></span>   // code
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>This produces the same value as <code>code</code>, but takes 3 seconds (assuming the evaluation of <code>code</code> took less than 3 seconds). Like <code>sleep</code>, also exists in a <code>start</code> variant: <code>delay(3.0, start)(code)</code>.</p> 
  </section>
  <section id="timeof"> 
   <h3><a href="#timeof" class="anchor"></a><code>timeOf</code></h3> 
   <p>The time it took to evaluate some code, in seconds:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.timing.timeOf
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val time = timeOf {
</span><span id="3" class=""><span class="tooltip-container"></span>   // code
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>The value produced by the code, if any, is ignored.</p> 
  </section>
  <section id="timeit"> 
   <h3><a href="#timeit" class="anchor"></a><code>timeIt</code></h3> 
   <p>The value produced by some code, and the time it took to compute it, as a pair:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.timing.timeIt
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val (value, time) = timeIt {
</span><span id="3" class=""><span class="tooltip-container"></span>   // code
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div>
  </section>
  <section id="timers"> 
   <h3><a href="#timers" class="anchor"></a>Timers</h3> 
   <p>Simple timers. Can be used explicitly:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.Executors
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val timer = Executors.newTimer(size = 2)
</span><span id="3" class=""><span class="tooltip-container"></span>val future = timer.schedule(1.5) {
</span><span id="4" class=""><span class="tooltip-container"></span>   // code 
</span><span id="5" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>or implicitly:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.{ DelayedFuture, Executors }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>given Timer = Executors.newTimer(2)
</span><span id="3" class=""><span class="tooltip-container"></span>val future = DelayedFuture(1.5) {
</span><span id="4" class=""><span class="tooltip-container"></span>   // code
</span><span id="5" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>Note that timers need to be explicitly shut down for their threads to terminate.</p> 
  </section>
  <section id="zipwithduration"> 
   <h3><a href="#zipwithduration" class="anchor"></a><code>zipWithDuration</code></h3> 
   <p>Asynchronously adds duration to a future:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.timing.zipWithDuration
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val future: Future[String] = ...
</span><span id="3" class=""><span class="tooltip-container"></span>val f: Future[(String, Double)] = future.zipWithDuration
</span></code></pre>
   </div> 
   <p>The second half of the pair is the duration (in seconds) between the invocation of <code>zipWithFuture</code> and the completion of <code>future</code>.</p> 
  </section>
  <section id="slow"> 
   <h3><a href="#slow" class="anchor"></a><code>slow</code></h3> 
   <p>A mechanism to slow down sources of values:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.timing.SlowIterator
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val i = Iterator.range(0, 1000)
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>val sum = i.sum // 499500
</span><span id="5" class=""><span class="tooltip-container"></span>val sum = i.slow(10.0).sum // 499500, but in about 10 seconds
</span><span id="6" class=""><span class="tooltip-container"></span>
</span><span id="7" class=""><span class="tooltip-container"></span>// first 10 elements delayed by about 1 second, then fast:
</span><span id="8" class=""><span class="tooltip-container"></span>i.slow(10.0, delayedElements = 10)
</span><span id="9" class=""><span class="tooltip-container"></span>
</span><span id="10" class=""><span class="tooltip-container"></span>// first 100 elements delayed by about 0.1 second, then fast
</span><span id="11" class=""><span class="tooltip-container"></span>i.slow(10.0, delayedElements = 100)
</span><span id="12" class=""><span class="tooltip-container"></span>
</span><span id="13" class=""><span class="tooltip-container"></span>// all elements delayed by about 0.001 second, then 9-second delay to finish
</span><span id="14" class=""><span class="tooltip-container"></span>i.slow(10.0, delayedElements = 10_000)
</span></code></pre>
   </div> 
   <p>Also available on <code>Source</code> and <code>LazyList</code>.</p> 
  </section>
  <section id="package-threads"> 
   <h2><a href="#package-threads" class="anchor"></a>Package <code>threads</code></h2> 
  </section>
  <section id="ortimeout"> 
   <h3><a href="#ortimeout" class="anchor"></a><code>orTimeout</code></h3> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.{ orTimeout, completeOnTimeout } 
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val f: Future[Int] = ...
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>// completes with value of f, or TimeoutException after 3 seconds
</span><span id="5" class=""><span class="tooltip-container"></span>val f1: Future[Int] = f.orTimeout(3.0)
</span><span id="6" class=""><span class="tooltip-container"></span>
</span><span id="7" class=""><span class="tooltip-container"></span>// same, but executes cancelCode after the timeout
</span><span id="8" class=""><span class="tooltip-container"></span>val f2: Future[Int] = f.orTimeout(3.0, cancelCode = ...)
</span><span id="9" class=""><span class="tooltip-container"></span>
</span><span id="10" class=""><span class="tooltip-container"></span>// completes with value of f, or of altCode if f times out after 3 seconds
</span><span id="11" class=""><span class="tooltip-container"></span>// if f completes during the execution of altCode, the value of f is used
</span><span id="12" class=""><span class="tooltip-container"></span>val f3: Future[Int] = f.completeOnTimeout(3.0)(altCode)
</span><span id="13" class=""><span class="tooltip-container"></span>
</span><span id="14" class=""><span class="tooltip-container"></span>// completes with value of f, or of altCode if f times out after 3 seconds
</span><span id="15" class=""><span class="tooltip-container"></span>// if f completes during the execution of altCode, the value of altCode is used
</span><span id="16" class=""><span class="tooltip-container"></span>val f4: Future[Int] = f.completeOnTimeout(3.0, strict = true)(altCode)
</span></code></pre>
   </div>
  </section>
  <section id="executors"> 
   <h3><a href="#executors" class="anchor"></a><code>Executors</code></h3> 
   <p>A facility to more easily create thread pools with customized thread factories and/or rejected execution handlers. All pools have type <code>ExecutionContextExecutorService</code> for easier use of both Java and Scala features.</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.Executors
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>// same as java.util.concurrent.Executors.newFixedThreadPool
</span><span id="3" class=""><span class="tooltip-container"></span>val exec = Executors.newThreadPool(4)
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>// sets a rejection policy
</span><span id="6" class=""><span class="tooltip-container"></span>val exec = Executors.withRejectionPolicy(rejectionPolicy).newThreadPool(4)
</span><span id="7" class=""><span class="tooltip-container"></span>
</span><span id="8" class=""><span class="tooltip-container"></span>// sets a "discard" rejection policy
</span><span id="9" class=""><span class="tooltip-container"></span>val exec = Executors.silent.newThreadPool(4)
</span><span id="10" class=""><span class="tooltip-container"></span>
</span><span id="11" class=""><span class="tooltip-container"></span>// sets a thread facyory
</span><span id="12" class=""><span class="tooltip-container"></span>val exec = Executors.withFactory(threadFactory).newThreadPool(2)
</span><span id="13" class=""><span class="tooltip-container"></span>
</span><span id="14" class=""><span class="tooltip-container"></span>// sets a rejection policy and a thread factory
</span><span id="15" class=""><span class="tooltip-container"></span>val exec = Executors
</span><span id="16" class=""><span class="tooltip-container"></span>   .withRejectionPolicy(rejectionPolicy)
</span><span id="17" class=""><span class="tooltip-container"></span>   .withFactory(threadFactory)
</span><span id="18" class=""><span class="tooltip-container"></span>   .newThreadPool(4)
</span><span id="19" class=""><span class="tooltip-container"></span>
</span><span id="20" class=""><span class="tooltip-container"></span>// sets a thread factory and a rejection policy (equivalent as above)
</span><span id="21" class=""><span class="tooltip-container"></span>val exec = Executors
</span><span id="22" class=""><span class="tooltip-container"></span>   .withFactory(threadFactory)
</span><span id="23" class=""><span class="tooltip-container"></span>   .withRejectionPolicy(rejectionPolicy)
</span><span id="24" class=""><span class="tooltip-container"></span>   .newThreadPool(4)
</span><span id="25" class=""><span class="tooltip-container"></span>
</span><span id="26" class=""><span class="tooltip-container"></span>// same as java.util.concurrent.Executors.newCachedThreadPool
</span><span id="27" class=""><span class="tooltip-container"></span>val exec = Executors.newUnlimitedThreadPool(60.0)
</span><span id="28" class=""><span class="tooltip-container"></span>
</span><span id="29" class=""><span class="tooltip-container"></span>// same as above, but terminates idle threads after 1 second instead of 1 minute
</span><span id="30" class=""><span class="tooltip-container"></span>val exec = Executors.newUnlimitedThreadPool()
</span><span id="31" class=""><span class="tooltip-container"></span>
</span><span id="32" class=""><span class="tooltip-container"></span>// sets a rejection policy and a thread factory, as with newThreadPool
</span><span id="33" class=""><span class="tooltip-container"></span>val exec = Executors
</span><span id="34" class=""><span class="tooltip-container"></span>   .withRejectionPolicy(rejectionPolicy)
</span><span id="35" class=""><span class="tooltip-container"></span>   .withFactory(threadFactory)
</span><span id="36" class=""><span class="tooltip-container"></span>   .newUnlimitedThreadPool()
</span></code></pre>
   </div> 
   <p>A <code>global</code> implicit is defined as an unlimited pool with a 1-second keep-alive time (and non-daemon threads):</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>given ExecutionContext = tinyscalautils.threads.Executors.global
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val f = Future { ... } // runs on global thread pool
</span></code></pre>
   </div>
  </section>
  <section id="runexecute"> 
   <h3><a href="#runexecute" class="anchor"></a><code>run</code>/<code>Execute</code></h3> 
   <p>Executes code on an executor:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.{ run, Execute }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>given exec: Executor = ...
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>exec.run {
</span><span id="5" class=""><span class="tooltip-container"></span>   // code
</span><span id="6" class=""><span class="tooltip-container"></span>}
</span><span id="7" class=""><span class="tooltip-container"></span>
</span><span id="8" class=""><span class="tooltip-container"></span>Execute {
</span><span id="9" class=""><span class="tooltip-container"></span>   // code
</span><span id="10" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>Both functions return <code>Unit</code> (no future).</p> 
  </section>
  <section id="keepthreadsfactory"> 
   <h3><a href="#keepthreadsfactory" class="anchor"></a><code>KeepThreadsFactory</code></h3> 
   <p>A thread factory that keeps a reference on all the threads it creates:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.{ KeepThreadsFactory, Executors }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val tf = KeepThreadsFactory()
</span><span id="3" class=""><span class="tooltip-container"></span>val exec = Executors.withFactory(threadFactory).newUnlimitedThreadPool()
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>// use the exec pool...
</span><span id="6" class=""><span class="tooltip-container"></span>
</span><span id="7" class=""><span class="tooltip-container"></span>val threads = tf.allThreads // all created threads so far, in order of creation
</span></code></pre>
   </div> 
   <p>The collection returned by <code>allThreads</code> is live: threads newly created by the factory will be added to it. The factory can be reset: threads created before the reset are discarded.</p> 
  </section>
  <section id="markedthreadsfactory"> 
   <h3><a href="#markedthreadsfactory" class="anchor"></a><code>MarkedThreadsFactory</code></h3> 
   <p>A cheaper alternative to <code>KeepThreadsFactory</code>: All the threads produced by the factory are distinguished by having type <code>MarkedThread</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.{ MarkedThreadsFactory, Executors }
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>given exec: ExecutionContextExecutorService =
</span><span id="3" class=""><span class="tooltip-container"></span>   Executors.withFactory(MarkedThreadsFactory).newThreadPool(4)
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>val future = Future(Thread.currentThread())
</span><span id="6" class=""><span class="tooltip-container"></span>val runner = Await.result(future, Duration.Inf)
</span><span id="7" class=""><span class="tooltip-container"></span>runner.isInstanceOf[MarkedThread] // true
</span></code></pre>
   </div> 
   <p>For convenience, an extension can be used to check for <code>MarkedThread</code> type:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.isMarkedThread
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>runner.isMarkedThread // true
</span></code></pre>
   </div>
  </section>
  <section id="awaittermination"> 
   <h3><a href="#awaittermination" class="anchor"></a><code>awaitTermination</code></h3> 
   <p>A variant of the standard <code>awaitTermination</code> method in which the timeout is optional and specified in seconds:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.awaitTermination
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val exec: ExecutorService = ...
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>if exec.awaitTermination(5.0) ... // waits at most 5 seconds
</span><span id="5" class=""><span class="tooltip-container"></span>if exec.awaitTermination() ...    // waits indefinitely
</span></code></pre>
   </div>
  </section>
  <section id="shutdownandwait"> 
   <h3><a href="#shutdownandwait" class="anchor"></a><code>shutdownAndWait</code></h3> 
   <p>Combines <code>shutdown</code>, <code>shutdownNow</code> and <code>awaitTermination</code> in one method:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.shutdownAndWait
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val exec: ExecutorService = ...
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>if exec.shutdownAndWait(5.0)
</span><span id="5" class=""><span class="tooltip-container"></span>   then // shutdown was invoked, and pool terminated within 5 seconds
</span><span id="6" class=""><span class="tooltip-container"></span>   else // shutdown was invoked, but pool did not terminate within 5 seconds
</span><span id="7" class=""><span class="tooltip-container"></span>
</span><span id="8" class=""><span class="tooltip-container"></span>if exec.shutdownAndWait(5.0, force = true)
</span><span id="9" class=""><span class="tooltip-container"></span>   then // shutdown was invoked, and pool terminated within 5 seconds
</span><span id="10" class=""><span class="tooltip-container"></span>   else // shutdown was invoked, then after 5 seconds, shutdownNow was invoked
</span><span id="11" class=""><span class="tooltip-container"></span>   
</span><span id="12" class=""><span class="tooltip-container"></span>exec.shutdownAndWait() // invokes shutdown and waits indefinitely; force flag is ignored
</span></code></pre>
   </div>
  </section>
  <section id="countdownandwait"> 
   <h3><a href="#countdownandwait" class="anchor"></a><code>countDownAndWait</code></h3> 
   <p>Combines <code>countDown</code> and <code>await</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.countDownAndWait
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val latch: CountDownLatch = ...
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>latch.countDownAndWait()
</span></code></pre>
   </div> 
   <p>Waiting uses a one-second timeout by default.</p> 
  </section>
  <section id="joined"> 
   <h3><a href="#joined" class="anchor"></a><code>joined</code></h3> 
   <p>Combines <code>join</code> and <code>isAlive</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.joined
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>if thread.joined(3.0)
</span><span id="3" class=""><span class="tooltip-container"></span>   then ... // thread is terminated (or never started)
</span><span id="4" class=""><span class="tooltip-container"></span>   else ... // 3-second timeout; thread may still be running
</span></code></pre>
   </div>
  </section>
  <section id="newthread"> 
   <h3><a href="#newthread" class="anchor"></a><code>newThread</code></h3> 
   <p>Kotlin-like functions for easier thread creation:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.newThread 
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val thread = newThread(name = "Joe", start = false, daemon = true, waitForChildren = false) {
</span><span id="3" class=""><span class="tooltip-container"></span>   // code
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>All arguments have default values and are optional. Be aware that <code>waitForChildren</code> only works if children are created within the same thread group (which is not always the case for the default thread factory of <code>java.util.concurrent.Executors</code>).</p> 
  </section>
  <section id="execution-contexts"> 
   <h3><a href="#execution-contexts" class="anchor"></a>Execution contexts</h3> 
   <p>Easy setup of execution contexts, mostly for testing:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.withThreadsAndWait
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val result = withThreadsAndWait(4) {
</span><span id="3" class=""><span class="tooltip-container"></span>   Future {
</span><span id="4" class=""><span class="tooltip-container"></span>      42
</span><span id="5" class=""><span class="tooltip-container"></span>   }   
</span><span id="6" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>This creates a 4-thread pool, runs the future on it, waits for the future to finish, shuts down the thread pool, and sets <code>result</code> to 42. Additionally, if <code>awaitTermination</code> is set to true, the constructs also waits for the thread pool to terminate before setting the result. All waiting is done without a timeout. Exists also as a <code>withUnlimitedThreadsAndWait</code> variant for an unbounded thread pool.</p> 
   <p>The preceding constructs require the code to produce a future. For a "fire-and-forget" approach, use <code>withThreads</code> and <code>withUnlimitedThreads</code>, which can use an arbitrary code.</p> 
   <p>These constructs create and shut down a new thread pool. To reuse an existing thread pool, use <code>withThreadPoolAndWait</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.threads.withThreadPoolAndWait
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val exec = Executors.newUnlimitedThreadPool()
</span><span id="3" class=""><span class="tooltip-container"></span>val result = withThreadPoolAndWait(exec) {
</span><span id="4" class=""><span class="tooltip-container"></span>   Future {
</span><span id="5" class=""><span class="tooltip-container"></span>      42
</span><span id="6" class=""><span class="tooltip-container"></span>   }   
</span><span id="7" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>This runs the future on the thread pool and waits for the future to finish before setting <code>result</code> to 42. The thread pool is left as-is. Alternatively, setting <code>shutdown</code> to true shuts down the thread pool after the future has completed (but does not not wait for the thread pool to terminate).</p> 
   <p>Note that if <code>shutdown</code> is known to be false at compile time, the thread pool doesn't need a <code>shutdown</code> method. In particular, it can be of type <code>Executor</code> or <code>ExecutionContext</code>:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>withThreadPoolAndWait(ExecutionContext.global, shutdown = false) {
</span><span id="1" class=""><span class="tooltip-container"></span>   Future {
</span><span id="2" class=""><span class="tooltip-container"></span>      ...
</span><span id="3" class=""><span class="tooltip-container"></span>   }
</span><span id="4" class=""><span class="tooltip-container"></span>}
</span></code></pre>
   </div> 
   <p>This runs the future on the global execution context, and waits for its termination.</p> 
  </section>
  <section id="package-io"> 
   <h2><a href="#package-io" class="anchor"></a>Package <code>io</code></h2> 
  </section>
  <section id="listpaths"> 
   <h3><a href="#listpaths" class="anchor"></a><code>listPaths</code></h3> 
   <p>The contents of a directory, as a list:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.io.listPaths
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>for (path: Path &lt;- listPaths(dir)) do ...
</span></code></pre>
   </div> 
   <p>If a list type is not suitable, use <code>readPaths</code> instead:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.io.readPaths
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val paths: Set[Path] = readPaths(Set)(dir)
</span></code></pre>
   </div> 
   <p><em>DO NOT</em> use a stream for the collection. Since the directory is closed before this function finishes, lazily evaluated collections won't work.</p> 
  </section>
  <section id="listlines"> 
   <h3><a href="#listlines" class="anchor"></a><code>listLines</code></h3> 
   <p>The contents of a UTF8 text file, as a list:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.io.listLines
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>for line: String &lt;- listLines(file) do ...
</span></code></pre>
   </div> 
   <p>If a list type is not suitable, use <code>readLines</code> instead:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.io.readLines
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val lines: IndexedSeq[String] = readLines(IndexedSeq)(file)
</span></code></pre>
   </div> 
   <p><em>DO NOT</em> use a stream for the collection. Since the file is closed before this function finishes, lazily evaluated collections won't work.</p> 
  </section>
  <section id="findresource"> 
   <h3><a href="#findresource" class="anchor"></a><code>findResource</code></h3> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.io.findResource
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val url = this.findResource(name)
</span></code></pre>
   </div> 
   <p>This is equivalent to <code>getClass.getResource(name)</code>, except that it throws an exception for missing resources (instead of returning <code>null</code>). In particular, a leading slash in the resource name makes it an absolute path, instead of being associated with the package name by default.</p> 
  </section>
  <section id="package-util"> 
   <h2><a href="#package-util" class="anchor"></a>Package <code>util</code></h2> 
  </section>
  <section id="fastrandom"> 
   <h3><a href="#fastrandom" class="anchor"></a><code>FastRandom</code></h3> 
   <p>Faster random number generators that don't rely on the <code>java.util.Random</code> thread-safe implementation. Individual instances are not thread-safe, but the singleton <code>FastRandom</code> can be shared among threads without contention:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.util.FastRandom
</span><span id="1" class=""><span class="tooltip-container"></span>impot scala.util.Random
</span><span id="2" class=""><span class="tooltip-container"></span>
</span><span id="3" class=""><span class="tooltip-container"></span>val rand: Random = FastRandom(42L) // fast, but not thread-safe
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>val rand: Random = FastRandom // fast, thread-safe, but cannot be seeded
</span></code></pre>
   </div> 
   <p>The implementation relies on <code>ThreadLocalRandom</code> and <code>SplittableRandom</code>, available in Java 11, not on the fancier generators that were added to Java 17.</p> 
  </section>
  <section id="nextint"> 
   <h3><a href="#nextint" class="anchor"></a><code>nextInt</code></h3> 
   <p>A Kotlin-inspired alternative to <code>pickOne</code> to select random numbers from a range:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.util.nextInt
</span><span id="1" class=""><span class="tooltip-container"></span>impot scala.util.Random
</span><span id="2" class=""><span class="tooltip-container"></span>
</span><span id="3" class=""><span class="tooltip-container"></span>val rand: Random = ...
</span><span id="4" class=""><span class="tooltip-container"></span>
</span><span id="5" class=""><span class="tooltip-container"></span>rand.nextInt(1 to 10)
</span><span id="6" class=""><span class="tooltip-container"></span>rand.nextInt(0 until 100)
</span></code></pre>
   </div> 
   <p>This looks nicer than <code>(1 to 10).pickone(using rand)</code> and <code>(0 until 100).pickone(using rand)</code>.</p> 
  </section>
  <section id="log2"> 
   <h3><a href="#log2" class="anchor"></a><code>log2</code></h3> 
   <p>Base 2 integer logarithm:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import tinyscalautils.util.log2
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>log2(1) // 0
</span><span id="3" class=""><span class="tooltip-container"></span>log2(7) // 2
</span><span id="4" class=""><span class="tooltip-container"></span>log2(8) // 3
</span></code></pre>
   </div>
  </section>
  <section id="average"> 
   <h3><a href="#average" class="anchor"></a><code>average</code></h3> 
   <p>Calculates an average by ignoring a fixed number of low/high values:</p> 
   <div class="snippet" scala-snippet="">
    <div class="buttons"></div>
    <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>val nums: Seq[BigDecimal] = Seq(1, 7, 9, 11, 12, 14)
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>average(nums) // (1 + 7 + 9 + 11 + 12 + 14) / 6
</span><span id="3" class=""><span class="tooltip-container"></span>average(nums, 1) // (7 + 9 + 11 + 12) / 4
</span><span id="4" class=""><span class="tooltip-container"></span>average(nums, 2) // (9 + 11) / 2
</span><span id="5" class=""><span class="tooltip-container"></span>average(nums, 3) // 0
</span></code></pre>
   </div> 
   <p>The function works on any <code>Fractional</code> type, including <code>Double</code>.</p> 
  </section> 
 </body>
</html></div></main><footer><div id="generated-by"><span class="footer-text">Generated by</span><a href="https://github.com/lampepfl/dotty/tree/main/scaladoc"><img src="../images/scaladoc_logo.svg" alt="scaladoc" class="scaladoc_logo"></img><img src="../images/scaladoc_logo_dark.svg" alt="scaladoc" class="scaladoc_logo_dark"></img></a></div><span id="footer-text">Copyright Michel Charpentier, 2022</span><div class="socials"><span class="footer-text"></span></div><div class="mode"><span class="footer-text">Mode</span><label id="theme-toggle" class="switch"><input type="checkbox"></input><span class="slider"></span></label></div><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span><span class="footer-text">Back to top</span></a></span></footer></div><div id="toc"><span class="toc-title">In this article</span><nav class="toc-nav"><ul class="toc-list"><li><a href="#code-examples">Code Examples</a><ul><li><a href="#package-lang">Package lang</a><ul><li><a href="#unit">unit</a></li><li><a href="#interruptibleconstructor--interruptibleequality">InterruptibleConstructor / InterruptibleEquality</a></li></ul></li><li><a href="#package-control">Package control</a><ul><li><a href="#times">times</a></li><li><a href="#limitedstack--stackoverflowexception">limitedStack / StackOverflowException</a></li><li><a href="#interruptibly">interruptibly</a></li></ul></li><li><a href="#package-collection">Package collection</a><ul><li><a href="#circular">circular</a></li><li><a href="#randomly">randomly</a></li><li><a href="#pickonepickoneoption">pickOne/pickOneOption</a></li></ul></li><li><a href="#package-assertions">Package assertions</a><ul><li><a href="#require--requirestate">require / requireState</a></li><li><a href="#checknonnull">checkNonNull</a></li><li><a href="#implies">implies</a></li><li><a href="#in">in</a></li></ul></li><li><a href="#package-text">Package text</a><ul><li><a href="#stringletterscharletters">StringLetters/CharLetters</a></li><li><a href="#shortpad">short/pad</a></li><li><a href="#printfprintln">printf/println</a></li><li><a href="#printout">printout</a></li></ul></li><li><a href="#package-timing">Package timing</a><ul><li><a href="#sleep">sleep</a></li><li><a href="#delay">delay</a></li><li><a href="#timeof">timeOf</a></li><li><a href="#timeit">timeIt</a></li><li><a href="#timers">Timers</a></li><li><a href="#zipwithduration">zipWithDuration</a></li><li><a href="#slow">slow</a></li></ul></li><li><a href="#package-threads">Package threads</a><ul><li><a href="#ortimeout">orTimeout</a></li><li><a href="#executors">Executors</a></li><li><a href="#runexecute">run/Execute</a></li><li><a href="#keepthreadsfactory">KeepThreadsFactory</a></li><li><a href="#markedthreadsfactory">MarkedThreadsFactory</a></li><li><a href="#awaittermination">awaitTermination</a></li><li><a href="#shutdownandwait">shutdownAndWait</a></li><li><a href="#countdownandwait">countDownAndWait</a></li><li><a href="#joined">joined</a></li><li><a href="#newthread">newThread</a></li><li><a href="#execution-contexts">Execution contexts</a></li></ul></li><li><a href="#package-io">Package io</a><ul><li><a href="#listpaths">listPaths</a></li><li><a href="#listlines">listLines</a></li><li><a href="#findresource">findResource</a></li></ul></li><li><a href="#package-util">Package util</a><ul><li><a href="#fastrandom">FastRandom</a></li><li><a href="#nextint">nextInt</a></li><li><a href="#log2">log2</a></li><li><a href="#average">average</a></li></ul></li></ul></li></ul></nav></div></div></body></html>